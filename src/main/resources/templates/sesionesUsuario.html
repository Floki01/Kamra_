<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/styles/inicio.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous"></script>
  <title>Kamra sanación y evolución</title>
</head>

<body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary" id="navbar">
    <div class="container-fluid" id="navbar-container">
      <a class="navbar-brand " id="navbar-margin" href="/user"> <img src="/resources/kamra.jpeg" id="icon-navbar">
        Kamra sanación y evolución</a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo02"
        aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse " id="navbarTogglerDemo02">
        <ul class="navbar-nav mb-2 mb-lg-0" id="ul-navbar">
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="/user/">Inicio</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/tarot">
              Tarot
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/ankh">Ankh</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/user/servicios">Agenda</a>
          </li>
        </ul>

        <ul class="navbar-nav mb-2 mb-lg-0" id="buttons-navbar">
          <li class="nav-item">
            <a class="nav-link" href="/user/consultas">
              <button class="btn btn-primary btn-sm" id="botones" type="submit">Mis consultas</button>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/login">
              <button class="btn btn-primary btn-sm" id="botones" type="submit">Salir</button>
            </a>
          </li>
        </ul>

      </div>
    </div>
  </nav>

  <div class="text-center fs-1 m-5 fw-medium consultas">Mis consultas</div>

  <div th:if="${consultas.size() == 0}" class="d-flex flex-column mb-3">
    <div class="d-flex flex-column mb-3 justify-content-center">
      <div class="text-center p-2"><span class="titulo">"¡Aprovecha esta oportunidad <br> para cuidar de ti! </span></div>
    </div>
    <div class="p-2"><a class="link-offset-2 link-underline link-underline-opacity-0" href="/user/servicios"><button
          class="button-56" role="button">Agenda aqui!</button></a>
    </div>
  </div>



  <div th:else class="container mx-auto border  hadow rounded">
    <div th:each="consulta:${consultas}" class="row m-3">
      <div class="col d-flex align-items-center justify-content-center">
        <h3><span class="badge spanUser fs-3 shadow" id="navbar-container"><span th:text="${consulta.sesion.dia.date}"></span></span></h3>
      </div>
      <div class="col text-center">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-watch" viewBox="0 0 16 16">
          <path d="M8.5 5a.5.5 0 0 0-1 0v2.5H6a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5V5z"/>
          <path d="M5.667 16C4.747 16 4 15.254 4 14.333v-1.86A5.985 5.985 0 0 1 2 8c0-1.777.772-3.374 2-4.472V1.667C4 .747 4.746 0 5.667 0h4.666C11.253 0 12 .746 12 1.667v1.86a5.99 5.99 0 0 1 1.918 3.48.502.502 0 0 1 .582.493v1a.5.5 0 0 1-.582.493A5.99 5.99 0 0 1 12 12.473v1.86c0 .92-.746 1.667-1.667 1.667H5.667zM13 8A5 5 0 1 0 3 8a5 5 0 0 0 10 0z"/>
        </svg>
        <span th:text="${consulta.sesion.hora}"></span><br>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard"
          viewBox="0 0 16 16">
          <path
            d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" />
          <path
            d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" />
        </svg>
        <span th:text="${consulta.servicio.nombre}"></span><br>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-currency-dollar"
          viewBox="0 0 16 16">
          <path
            d="M4 10.781c.148 1.667 1.513 2.85 3.591 3.003V15h1.043v-1.216c2.27-.179 3.678-1.438 3.678-3.3 0-1.59-.947-2.51-2.956-3.028l-.722-.187V3.467c1.122.11 1.879.714 2.07 1.616h1.47c-.166-1.6-1.54-2.748-3.54-2.875V1H7.591v1.233c-1.939.23-3.27 1.472-3.27 3.156 0 1.454.966 2.483 2.661 2.917l.61.162v4.031c-1.149-.17-1.94-.8-2.131-1.718H4zm3.391-3.836c-1.043-.263-1.6-.825-1.6-1.616 0-.944.704-1.641 1.8-1.828v3.495l-.2-.05zm1.591 1.872c1.287.323 1.852.859 1.852 1.769 0 1.097-.826 1.828-2.2 1.939V8.73l.348.086z" />
        </svg>
        <span th:text="${consulta.servicio.precio}"></span>
      </div>
      <div class="col d-flex align-items-center justify-content-center">
        <button class="button-54" id="btn-cancelar" th:data-id="${consulta.id}"
          th:onclick="my(this.getAttribute('data-id'))">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle"
            viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"></path>
            <path
              d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z">
            </path>
          </svg>
          Cancelar sesion
        </button>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <div class="modal" id="myModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">¿Esta seguro que quiere cancelar la sesion?</h5>
        </div>
        <div class="modal-footer">
          <button id="btn-cancel" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
          <button id="btn-aceptar" class="btn btn-primary">Aceptar</button>
        </div>
      </div>
    </div>
  </div>

  <script th:inline="javascript">

    function my(valor) {

      $(document).ready(function () {

        $('#myModal').show('show');

        $('#btn-aceptar').click(function () {
          $.ajax({
            url: '/user/cancelar/' + valor,
            method: 'GET',
            success: function (response) {
              location.reload();
              window.location.href = '/user/consultas?success';
            },
            error: function (error) {

            }
          })
        })

        $('#btn-cancel').click(function () {
          $('#myModal').hide()
        })

      })

    }


  </script>


</body>

</html>